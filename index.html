<!DOCTYPE html>
<html>
<head>
	<title>Javascript Grapher, Function plotter and Chart generator online</title>
	<meta charset="utf-8" /> 
	<link rel="icon" href="data:image/x-icon;base64,AAABAAEAICAQAAEABADoAgAAFgAAACgAAAAgAAAAQAAAAAEABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAGh0bACcpKAA6PTsATU9OAF1gXgBucG8AfX9+AJCTkQCjp6UAwsbEAM3QzgDe4uAA6ezqAPz//QAAAAAA7u7u7u7IUhAAJYvu7u7u7u7u7u7XIAAAAAACau7u7u7u7u7d5QAAAAAAAAF97u7u7u7rNusQAAAAAAAAA77u7u7uogCucAAAAAAAAAAq7u7u6yAATdIAAAAAAAAAAr7u7tMAAAnoAAAAAAAAAAA97u5wAAAC3kABEAAAAAAAB+7qEAAAAH6oq8qDAAAAAAGu5gAAAAAt7u7u7YEAAAAAbrIAAAAAnu7u7u7pAAAAACuAAAAACO7u7u7u7oAAAAAIQAAAAD3u7u7u7u7TAAAABCAAAACO7u7u7u7u6AAAAAIAAAAAru7u7u7u7usAAAAAAAAAAc7u7u7u7u7sEAAAAAAAAAHO7u7u7u7u7BAAAAAAAAAAvu7u7u7u7uoAAAAAIAAAAI7u7u7u7u7oAAAAAkAAAAA97u7u7u7u60AAAASAAAAACO7u7u7u7t7ZIAAIsQAAAAGe7u7u7ukn3scQHOUAAAAAGN7u7u2BADnetW7rEAAAAAA4vuqDAAAASu7e7mAAAAAAACzSAAAAAABt7u7TAAAAAAAcwQAAAAAAPO7u6hAAAAAAHNEAAAAAAa7u7u6iAAAAABzBAAAAACru7u7u6jAAAAAc0QAAAAOu7u7u7u7GEAAAHMEAAAFs7u7u7u7u7qYQABzRAAJa7u7u7u7u7u7uuEIswhSL7u7u7u4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==">
	<meta name="description" content="Opensource javascript grapher, function plotter and chart generator. You can export them and use for totally free. ">
	<meta name="keywords" content="javascript, grapher, graph, chart, pie, line, bar, radar, polar area, open source, free, function plotter, save, export">

	<script src="jquery-3.2.1.min.js"></script>
	<script src="Chart.min.js"></script>
	<script src='spectrum.js'></script>
	<link rel='stylesheet' href='spectrum.css' />
	<style>

body, html {
	margin: 0;
	padding: 0;
	background-color: #ffffff;
	font-family: Arial, sans-serif;
}
#graph {
	width: 1000px;
	margin: 100px auto;
	padding: 0px;
}
#content {
	width: 800px;
	margin: 30px auto 50px auto;
	padding: 15px;
}
input, select, textarea {
	width: 98%;
	border-radius: 0;
	margin: 0;
	padding: 5px 1%;
	background: #fffbfb;
	border: 1px solid #dddddd;
	font-family: Arial, sans-serif;
	margin-bottom: 3px;
}
input[type=submit] {
	background-color: #efefef;
}
h3 {
	margin: 15px 0px 10px 0px;
}
.float33 {
	width: 31.2%;
	margin-right: 2%;
	float: left;
}
.float50 {
	width: 47.9%;
	margin-right: 2%;
	float: left;
}
.float input {
	width: 94%;
	padding: 5px 3%;
}
@media screen and (min-width: 1760px) {
	#content {
		width: 1760px;
		column-gap: 58px;
		-webkit-columns: 2 750px;
		-moz-columns: 2 750px;
		columns: 2 750px;
		margin: 0 auto 50px auto;
		padding: 0;
	}
}
</style>

</head>
<body onload="ready();">
<!-- This is only quick'n'dirty script for graphs rendering, when Google grapher is not enough -->
	<div id="graph">
		<canvas id="chart" style="width: 100%; height: 500px"></canvas>
	</div>
	<!--<div id="content">
		<p><a id="url_down" download="graph.png" style="color: #0000ee; cursor: pointer;">Download as image</a></p>

		<form id="settings" method="POST" onsubmit="return chart_update();" onchange="chart_update();">
			<input type="submit" value="Redraw is automatic">
		</form>

		<p>
		<placeholder for="url2">Link to your settings (click to open in new window)</placeholder>
		<a id="url2" target="_blank"><textarea readonly id="url" style="margin-bottom: 10px; height: 50px; resize: none;"></textarea></a>
		<a href='https://github.com/dalibor-drgon/grapher' target='_blank' style='display:block;text-decoration: none'>Javascript Grapher, Free to use, under MIT license</a>
		</p>
	</div>-->

	<div id="content">
		<p><a id="url_down" download="graph.png" style="color: #0000ee; cursor: pointer;">Download as image</a>
		</p>

		<form id="settings" method="POST" onsubmit="return chart_update();" onchange="chart_update();">
			<input type="submit" value="Redraw is automatic">

			<h3>Calculations</h3>
			<placeholder>init</placeholder>
			<textarea name="init" rows="4">// Plot your functions and graphs with Javascript
dummy = sqrt(1 + PI)</textarea>
			<placeholder>y1</placeholder>
			<textarea name="y1" rows="4">y=x*x-3*x-dummy</textarea>
			<placeholder>y2</placeholder>
			<textarea name="y2" rows="4">y=-2*x*x+11.3</textarea>
			<placeholder>y3</placeholder>
			<textarea name="y3" rows="4">y=62*x-123</textarea>
			<placeholder>y4</placeholder>
			<textarea name="y4" rows="4"></textarea>

			<div style="overflow: auto; margin-bottom: 9px;">
				<div class="float float33">
					<placeholder>Minimum</placeholder>
					<input name="min" type="text" value="0">
				</div>

				<div class="float float33">
					<placeholder>Maximum</placeholder>
					<input name="max" type="text" value="50">
				</div>

				<div class="float float33">
					<placeholder>step</placeholder>
					<input name="step" type="text" value="1">
				</div>
			</div>

			<placeholder>Description</placeholder>
			<textarea name="desc" rows="3"></textarea>

			<h3>Naming</h3>
			<placeholder>label1</placeholder>
			<input name="label1" type="text" value="Red">
			<placeholder>label2</placeholder>
			<input name="label2" type="text" value="Green">
			<placeholder>label3</placeholder>
			<input name="label3" type="text" value="Blue">
			<placeholder>label4</placeholder>
			<input name="label4" type="text" value="Yellow">
			<placeholder>title</placeholder>
			<input name="title" type="text" value="Something fancy going on">

			<h3>Design</h3>
			<p>
				<placeholder>color1</placeholder>
				<input id="color1" name="color1" type="text" value="rgba(255, 0, 0, 0.5)">

				<placeholder>color2</placeholder>
				<input id="color2" name="color2" type="text" value="rgba(0, 255, 0, 0.5)">

				<placeholder>color3</placeholder>
				<input id="color3" name="color3" type="text" value="rgba(0, 0, 255, 0.5)">

				<placeholder>color4</placeholder>
				<input id="color4" name="color4" type="text" value="rgba(255, 205, 55, 0.50)">
			</p>

			<div style="overflow: auto;">
				<div class="float float50">
					<placeholder>width</placeholder>
					<input name="width" type="text" value="800px">
				</div>

				<div class="float float50">
					<placeholder>height</placeholder>
					<input name="height" type="text" value="500px">
				</div>
			</div>
			<placeholder>titleSize</placeholder>
			<input name="titleSize" type="text" value="16px">
			<placeholder>type</placeholder>
			<select name="type">
				<option value="line">line</option>
				<option value="bar">bar</option>
				<option value="radar">radar</option>
				<option value="polarArea">polarArea</option>
			</select>

			<placeholder>legend</placeholder>
			<select name="legend">
				<option value="top">top</option>
				<option value="bottom">bottom</option>
				<option value="left">left</option>
				<option value="right">right</option>
				<option value="none">none</option>
			</select>
		</form>

		<p>
			<placeholder for="url2">Link to your settings (click to open in new window)</placeholder>
			<a id="url2" target="_blank">
				<textarea readonly="" id="url" style="margin-bottom: 10px; height: 50px; resize: none;"></textarea>
			</a>
			<a href='https://github.com/dalibor-drgon/grapher' target='_blank' style='display:block;text-decoration: none'>Javascript Grapher, Free to use, under MIT license</a>
		</p>
	</div>

	<script src="Notifier.js"></script>

	<script type="text/javascript">

function _eval(str) {
	_func = str;
	try {
		return (function(str) {
			return eval(str);
		}).call(Math, str);
	} catch(e) {
		console.log(_e = e);
		Notifier.error(e);
	}
	return null;
}

var Data = [10, 12, 30, 41, 0];

Chart.defaults.global.elements.point.hitRadius=5;

var form = $("#settings")[0];
var chart_el = $("#chart")[0];
var chart_config = {
	type: 'line',
	data: {
		datasets: [/*{
			data: [20, 50, 100, 75, 25, 0],
			label: 'Left dataset',

			// This binds the dataset to the left y axis
			yAxisID: 'left-y-axis'
		}*/],
		labels: [0,1,2,3,4,5]
	},
	options: {
		scales: {
			yAxes: [{
				id: 'left-y-axis',
				type: 'linear',
				position: 'left'
			}]
		},
		layout: {
			padding: {
				left: 0,
				right: 0,
				top: 0,
				bottom: 0
			}
		},
		tooltips: {
			position: 'nearest',
			mode: 'x',
			intersect: true
		},
		title: {},
		legend: {},
		responsive: false,
		maintainAspectRatio: false
	}
};

var chart;

function e(name) {
	return form.elements[name];
}

function v(s) {
	var el = e(s);
	return el.value || el.innerHTML;
}

function i(s) {
	return Number.parseFloat(v(s));
}

function s(s,o) {
	form.elements[s].value = o;
}

function px(s) {
	return s.replace('px', '');
}

y0 = 0;

function calculate(min, step, steps, n) {
	var color = v("color"+n);
	var label = v("label"+n);
	var func = v("y"+n).trim();
	console.log(lf = func);
	if(func.length < 1) return;
	if(func.indexOf('y') == -1) func = "y="+func; //add y= if missing

	y = y0;
	var data = [];
	for(var i = 0; i < steps; i++) {

		x = min; //x and y are globals and used by eval
		_eval(func);
		data[i] = y;

		min += step;
	}

	var ds = {
		data: data,
		label: label,
		yAxisID: 'left-y-axis',
		backgroundColor: color,
		borderWidth: 0.5,
		hoverBorderWidth: 0
	};
	chart_config.data.datasets.push(ds);
}

function gen_data(min, step, steps) {
	var arr = [];
	for(var i = 0; i < steps; i++) {
		arr[i] = min;
		min += step;
	}
	return arr;
}

function ready() {
	create_elements();

	//Parse data after #

	var ind = window.location.href.indexOf('#');
	if(ind != -1) {
		deparam(window.location.href.substring(ind+1), form.elements);
	}

	chart_update();
}

// el - settings or form.elements
function chart_update() {
	if(chart != null) chart.destroy();

//Recaclulate values
	document.getElementById("url2").href = document.getElementById("url").value = window.location.href.split("#")[0] + "#" +$(form).serialize();

	_eval(v('init'));
	var min = i('min'), max = i('max'), step = i('step');
	var steps = Math.round((max-min)/step);

	chart_config.data.labels = gen_data(min, step, steps);
	chart_config.data.datasets = [];

	calculate(min, step, steps, 1);
	calculate(min, step, steps, 2);
	calculate(min, step, steps, 3);
	calculate(min, step, steps, 4);


//Set design
	var str = v('title');
	chart_config.options.title.display = str != null && (str = str.trim()).length > 0;
	chart_config.options.title.text    = str;
	chart_config.options.title.fontSize = i('titleSize');
	if(str != null && str.length > 0) {
		document.getElementById("url_down").download = str.replace("/", "-").replace("\\", "-") + ".png";
	}

	chart_config.type = v('type');

	str = v('legend');
	chart_config.options.legend.display = str && str != "none";
	chart_config.options.legend.position = str;

	/*chart_config.options.layout.padding = {
		left: v('pad_left'),
		right: v('pad_right'),
		top: v('pad_top'),
		bottom: v('pad_bottom')
	};*/


//Resize update and finish
	chart_el.getContext("2d").canvas.width = 
	px(document.getElementById("graph").style.width = chart_el.style.width = 
		v('width'));
	chart_el.getContext("2d").canvas.height = 
	px(chart_el.style.height = 
		v('height'));

	chart = new Chart(chart_el, jQuery.extend(true, {}, chart_config));

	//chart.resize();
	//chart.update();

	return false;
}

function copy(to, obj, it) {
	for (var i in it) {
		var attr = it[i]
		if (obj.hasOwnProperty(attr)) to[attr] = obj[attr];
	}
}

function deparam(query, elements) {
	// remove leading question mark if its there
	if (query !== '') {
		var pairs = query.split('&');
		for (var i = 0; i < pairs.length; i += 1) {
			var cur = pairs[i];
			var eq_index = cur.indexOf('=');
			key = (eq_index == -1) ? cur : decodeURIComponent(cur.substring(0, eq_index));
			value = (eq_index == -1) ? null : decodeURIComponent(cur.substring(eq_index+1));
			if(elements[key]) elements[key].value = value;
		}
	}
}

function colorise(el) {
	$(el).spectrum({
		showInitial: true,
		showInput: true,
		showAlpha: true,
		preferredFormat: "rgb",
		showPalette: true,
		palette: [
			["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],
			["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],
			["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],
			["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],
			["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],
			["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],
			["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],
			["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]
		]

	});
}

function download() {
	var dt = chart_el.getContext("2d").canvas.toDataURL('image/png');
	this.href = dt;
};

function create_elements() {

	document.getElementById("url_down").addEventListener('click', download, false);

	// Move all math functions to global
	copy(window, Math, ["abs", "acos", "asin", "atan", "atan2", "ceil", "cos", "exp", "floor", "log", "max", "min", "pow", "random", "round", "sin", "sqrt", "tan", "PI", "E"]);

	colorise("#color1");
	colorise("#color2");
	colorise("#color3");
	colorise("#color4");

	var w = window,
	d = document,
	_e = d.documentElement,
	g = d.getElementsByTagName('body')[0],
	x = w.innerWidth || _e.clientWidth || g.clientWidth;

	var wel = e('width');
	if(x > 820) {
		wel.value = Math.min(1200, x-20)+"px";
	} else {
		wel.value =  "800px";
	}

};

	</script>
</body>
</html>
